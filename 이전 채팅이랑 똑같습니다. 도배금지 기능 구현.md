---
title: "이전 채팅이랑 똑같습니다. 도배금지 기능 구현"
date: "2025-04-25"
thumbnail: "https://i.ytimg.com/vi/D5VeF_cAK2M/hqdefault.jpg"
tags: ["중급", "베드락", "스크립트API", "소스코드", "설계자", "롱폼"]
url: "https://www.youtube.com/watch?v=D5VeF_cAK2M"
duration: "4:20"
series: null
episode: null
difficulty: "중급"
---

# 이전 채팅이랑 똑같습니다. 도배금지 기능 구현

<div align="center">
<img src="https://i.ytimg.com/vi/D5VeF_cAK2M/hqdefault.jpg" alt="썸네일" width="600"/>
</div>

## 목차
- [소개](#소개)
- [주요 내용](#주요-내용)
- [도배 방지 시스템 기능](#도배-방지-시스템-기능)
- [코드 구조 분석](#코드-구조-분석)
- [기술적 구현 방법](#기술적-구현-방법)
- [자주 묻는 질문](#자주-묻는-질문)
- [추가 리소스](#추가-리소스)

## 소개

이 영상은 마인크래프트 베드락 에디션에서 Script API를 활용하여 채팅 도배 방지 시스템을 구현하는 방법을 설명합니다. 동일한 메시지 반복 전송 차단, 메시지 길이 제한, 채팅 속도 제한 등의 기능을 통해 채팅창을 깔끔하게 관리할 수 있는 시스템을 구축하는 과정을 상세히 보여줍니다.

## 주요 내용

### 1. 도배 방지 시스템 개요
- 채팅창 스팸 및 도배 행위 차단
- 동일 메시지 반복 전송 방지
- 메시지 길이 제한 기능
- 채팅 속도 제한 시스템

### 2. 핵심 기능
- **중복 메시지 차단**: 이전 채팅과 동일한 내용 전송 방지
- **문자 수 제한**: 최대 10글자까지만 허용
- **속도 제한**: 빠른 연속 채팅 방지 (0.5초 간격)
- **실시간 알림**: 위반 시 즉시 경고 메시지 표시

### 3. 기술적 특징
- Script API의 이벤트 시스템 활용
- 동적 속성(Dynamic Properties)을 통한 데이터 저장
- 스코어보드를 이용한 시간 간격 관리
- setInterval을 통한 주기적 시간 감소

## 도배 방지 시스템 기능

### 중복 메시지 차단
- 플레이어의 마지막 채팅 메시지 저장
- 새로운 메시지와 이전 메시지 비교
- 동일한 경우 메시지 전송 차단 및 경고

### 메시지 길이 제한
- 최대 허용 글자 수: 10글자
- 초과 시 "너무 길다" 메시지와 함께 차단
- 한글, 영문 모두 동일하게 적용

### 채팅 속도 제한
- 허용 간격: 0.5초 (10틱)
- 빠른 연속 채팅 시 "너무 빠르다" 메시지
- 스코어보드 기반 시간 추적 시스템

## 코드 구조 분석

### 채팅 이벤트 처리
```javascript
// 채팅 메시지 전송 시 이벤트 감지
world.beforeEvents.chatSend.subscribe((eventData) => {
    const message = eventData.message;
    const player = eventData.player;
    
    // 도배 검사 로직 실행
});
```

### 중복 메시지 검사
```javascript
// 이전 채팅 메시지 가져오기
const lastChat = player.getDynamicProperty("lastChat");

// 이전 메시지와 현재 메시지 비교
if (lastChat === message) {
    eventData.cancel = true;
    player.sendMessage("이전 채팅이랑 똑같습니다.");
    return;
}
```

### 메시지 길이 검사
```javascript
// 최대 메시지 길이 설정 (10글자)
const MAX_MESSAGE_LENGTH = 10;

// 메시지 길이 확인
if (message.length > MAX_MESSAGE_LENGTH) {
    eventData.cancel = true;
    player.sendMessage("메시지가 너무 깁니다.");
    return;
}
```

### 채팅 속도 제한
```javascript
// 채팅 속도 제한 시간 (틱 단위)
const CHAT_SPEED_LIMIT = 10;

// 스코어보드를 통한 시간 추적
const chatSpeed = scoreboard.getScore(player);

if (chatSpeed > 0) {
    eventData.cancel = true;
    player.sendMessage("채팅 속도가 너무 빠릅니다.");
    return;
}

// 정상 채팅 시 스코어보드에 제한 시간 설정
scoreboard.setScore(player, CHAT_SPEED_LIMIT);
```

## 기술적 구현 방법

### 데이터 저장 시스템
- **동적 속성**: 플레이어별 마지막 채팅 저장
- **스코어보드**: 채팅 속도 제한 시간 추적
- **메모리 효율성**: 필요한 데이터만 저장

### 시간 관리 시스템
```javascript
// 주기적 시간 감소 시스템
system.runInterval(() => {
    // 모든 플레이어의 채팅 속도 스코어 감소
    for (const player of world.getAllPlayers()) {
        const currentScore = getScore(player, "chatSpeed");
        if (currentScore > 0) {
            removefromScore(player, "chatSpeed", 1);
        }
    }
}, 1); // 1틱마다 실행
```

### 이벤트 취소 메커니즘
- `eventData.cancel = true`로 메시지 전송 차단
- 위반 사유별 맞춤형 피드백 메시지
- 정상적인 채팅은 그대로 진행

## 자주 묻는 질문

**Q: 메시지 길이 제한을 변경할 수 있나요?**
A: 네, `MAX_MESSAGE_LENGTH` 상수 값을 수정하면 원하는 길이로 조정할 수 있습니다.

**Q: 채팅 속도 제한 시간을 바꿀 수 있나요?**
A: `CHAT_SPEED_LIMIT` 값을 조정하여 제한 시간을 변경할 수 있습니다. 20틱 = 1초입니다.

**Q: 관리자는 도배 방지 기능에서 제외할 수 있나요?**
A: 코드에 권한 검사 로직을 추가하여 특정 플레이어나 관리자를 예외 처리할 수 있습니다.

**Q: 여러 언어의 문자도 정확히 계산되나요?**
A: JavaScript의 length 속성을 사용하므로 한글, 영문, 특수문자 모두 정확히 계산됩니다.

**Q: 시스템이 서버 성능에 미치는 영향은?**
A: 매우 경량화된 시스템으로 서버 성능에 거의 영향을 주지 않습니다.

## 추가 리소스

### 관련 가이드
- [Script API 시작하기 가이드](https://youtu.be/zBVdaQ0AXOY)
- [베드락 에디션 스크립트 API 문서](링크)
- [스코어보드 활용법](링크)
- [동적 속성 사용 가이드](링크)

### 소스코드
- [도배방지 시스템 소스코드](링크)
- [Script API 예제 모음](링크)

## 이런 분들에게 추천합니다

- 서버 채팅 관리에 어려움을 겪는 운영자들
- Script API를 활용한 실용적인 기능에 관심 있는 개발자들
- 코드 리딩을 통해 프로그래밍을 학습하고 싶은 분들
- 마인크래프트 서버의 질서 유지에 관심 있는 관리자들
- 이벤트 시스템과 데이터 관리를 배우고 싶은 초중급 개발자들

## 관련 튜토리얼

- [채팅 필터 시스템 구현]
- [플레이어 권한 관리 시스템]
- [서버 로그 시스템 만들기]
- [자동 경고 및 제재 시스템]

## 확장 가능한 기능들

### 고급 기능 추가
1. **욕설 필터링**: 금지어 목록과 자동 차단
2. **누적 경고 시스템**: 위반 횟수에 따른 단계적 제재
3. **관리자 알림**: 도배 시도 시 관리자에게 자동 알림
4. **통계 시스템**: 플레이어별 위반 횟수 추적
5. **화이트리스트**: 신뢰할 수 있는 플레이어 예외 처리

### 세분화된 제어
1. **시간대별 제한**: 특정 시간에 더 엄격한 제한
2. **등급별 제한**: 플레이어 등급에 따른 차등 제한
3. **채널별 관리**: 일반채팅/공지채팅 등 채널별 다른 규칙

## 구현 세부사항

### 스코어보드 관리 함수
```javascript
// 스코어보드 생성
function createScoreboard() {
    try {
        world.scoreboard.addObjective("chatSpeed", "Chat Speed");
    } catch (e) {
        // 이미 존재하는 경우 무시
    }
}

// 스코어 가져오기
function getScore(player, objective) {
    try {
        return world.scoreboard.getObjective(objective).getScore(player);
    } catch (e) {
        return 0;
    }
}

// 스코어 설정
function setScore(player, objective, value) {
    world.scoreboard.getObjective(objective).setScore(player, value);
}

// 스코어 감소
function removeFromScore(player, objective, amount) {
    const currentScore = getScore(player, objective);
    if (currentScore > 0) {
        setScore(player, objective, Math.max(0, currentScore - amount));
    }
}
```

### 동적 속성 관리
```javascript
// 마지막 채팅 저장
function saveLastChat(player, message) {
    player.setDynamicProperty("lastChat", message);
}

// 마지막 채팅 불러오기
function getLastChat(player) {
    return player.getDynamicProperty("lastChat") || "";
}
```

### 완전한 도배 방지 시스템
```javascript
// 채팅 도배 방지 시스템 초기화
function initAntiSpamSystem() {
    createScoreboard();
    
    // 채팅 이벤트 리스너
    world.beforeEvents.chatSend.subscribe((eventData) => {
        const message = eventData.message;
        const player = eventData.sender;
        
        // 1. 중복 메시지 검사
        const lastMessage = getLastChat(player);
        if (lastMessage === message) {
            eventData.cancel = true;
            player.sendMessage("§c이전 채팅이랑 똑같습니다.");
            return;
        }
        
        // 2. 메시지 길이 검사
        if (message.length > MAX_MESSAGE_LENGTH) {
            eventData.cancel = true;
            player.sendMessage("§c메시지가 너무 깁니다. (최대 " + MAX_MESSAGE_LENGTH + "글자)");
            return;
        }
        
        // 3. 채팅 속도 검사
        const chatSpeed = getScore(player, "chatSpeed");
        if (chatSpeed > 0) {
            eventData.cancel = true;
            player.sendMessage("§c채팅 속도가 너무 빠릅니다. 잠시 후 다시 시도해주세요.");
            return;
        }
        
        // 정상 채팅 처리
        saveLastChat(player, message);
        setScore(player, "chatSpeed", CHAT_SPEED_LIMIT);
    });
    
    // 주기적 스코어 감소
    system.runInterval(() => {
        for (const player of world.getAllPlayers()) {
            removeFromScore(player, "chatSpeed", 1);
        }
    }, 1);
}

// 시스템 초기화
initAntiSpamSystem();
```

## 시스템 설정 상수
```javascript
// 도배 방지 시스템 설정
const MAX_MESSAGE_LENGTH = 10;        // 최대 메시지 길이
const CHAT_SPEED_LIMIT = 10;          // 채팅 속도 제한 (틱)
const SCOREBOARD_NAME = "chatSpeed";  // 스코어보드 이름

// 메시지 상수
const MESSAGES = {
    DUPLICATE: "§c이전 채팅이랑 똑같습니다.",
    TOO_LONG: "§c메시지가 너무 깁니다.",
    TOO_FAST: "§c채팅 속도가 너무 빠릅니다."
};
```

## 성능 최적화 팁

### 메모리 관리
- 필요한 데이터만 동적 속성에 저장
- 주기적으로 사용하지 않는 데이터 정리
- 효율적인 문자열 비교 알고리즘 사용

### 처리 속도 개선
- 조건문의 순서를 빈도에 따라 최적화
- 불필요한 연산 최소화
- 캐싱을 통한 반복 계산 방지

## 보안 고려사항

### 우회 방지
- 공백, 특수문자를 통한 우회 차단
- 대소문자 구분 없는 중복 검사
- 유사한 메시지 패턴 인식

### 권한 관리
- 관리자 권한 검증
- 시스템 명령어와 일반 채팅 구분
- 로그 기록 및 모니터링

## 교육적 가치

### 프로그래밍 학습
- 이벤트 기반 프로그래밍 이해
- 상태 관리 시스템 구현
- 조건문과 데이터 구조 활용

### 시스템 설계
- 사용자 경험 고려한 제한 설정
- 확장 가능한 아키텍처 설계
- 성능과 기능의 균형점 찾기

## 태그

#마인크래프트 #베드락에디션 #ScriptAPI #도배방지 #채팅관리 #스팸차단 #서버관리 #스티브코딩 #프로그래밍 #이벤트처리